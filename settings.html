<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>COMPASS - Settings</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js" defer></script>
    <script src="script.js" defer></script>
    <style>
        /* Add this to fix Profile Settings input fields */
.input-field {
    width: 100%;
    padding: 15px 20px;
    border: 2px solid var(--card-border);
    border-radius: 15px;
    background: rgba(255, 255, 255, 0.95);
    color: var(--fg);
    font-size: 16px;
    transition: all 0.3s ease;
    box-sizing: border-box;
}

.input-field:focus {
    outline: none;
    border-color: var(--accent-1);
    box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
    transform: translateY(-2px);
}

.input-field:hover {
    border-color: var(--accent-2);
}

/* Add this for better label styling */
.settings-card label {
    display: block;
    margin-bottom: 8px;
    font-weight: 600;
    color: var(--fg);
    font-size: 15px;
}

/* Add this for form field containers */
.settings-card > div > div {
    margin-bottom: 20px;
}

/* Add placeholder styling */
.input-field::placeholder {
    color: var(--muted-2);
    opacity: 0.7;
}
        .settings-section {
            margin-bottom: 40px;
        }

        .settings-card {
            padding: 30px;
            border-radius: 25px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(255, 255, 255, 0.9));
            border: 2px solid var(--card-border);
            margin-bottom: 20px;
            transition: all 0.3s ease;
            animation: slideUp 0.5s ease-out;
        }

        .settings-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 30px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, var(--muted-2), color-mix(in oklab, var(--muted-2) 50%, transparent));
            transition: .4s;
            border-radius: 34px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked+.toggle-slider {
            background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
        }

        input:checked+.toggle-slider:before {
            transform: translateX(30px);
        }

        .avatar-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .avatar-option {
            width: 80px;
            height: 80px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid transparent;
        }

        .avatar-option:hover {
            transform: scale(1.1);
        }

        .avatar-option.selected {
            border-color: var(--accent-1);
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.3);
        }

        .color-option {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid transparent;
        }

        .color-option:hover {
            transform: scale(1.2);
        }

        .color-option.selected {
            border-color: white;
            box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.2);
        }

        .notification-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            margin-bottom: 15px;
            border: 2px solid var(--card-border);
            transition: all 0.3s ease;
        }

        .notification-item:hover {
            border-color: var(--accent-1);
            transform: translateX(5px);
        }

        .export-option {
            padding: 25px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            margin-bottom: 15px;
            border: 2px solid var(--card-border);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .export-option:hover {
            border-color: var(--accent-1);
            transform: translateY(-5px);
        }

        .danger-zone {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(239, 68, 68, 0.05));
            border: 2px solid rgba(239, 68, 68, 0.3);
        }

        @keyframes wiggle {

            0%,
            100% {
                transform: rotate(0deg);
            }

            25% {
                transform: rotate(-5deg);
            }

            75% {
                transform: rotate(5deg);
            }
        }

        .wiggle {
            animation: wiggle 0.5s ease-in-out;
        }

        /* Export Modal Styles */
        .export-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .export-modal-content {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(255, 255, 255, 0.9));
            border-radius: 25px;
            padding: 30px;
            width: 90%;
            max-width: 500px;
            border: 2px solid var(--card-border);
            animation: slideUp 0.3s ease-out;
            position: relative;
        }

        .export-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .export-modal-title {
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--fg);
            font-size: 20px;
            font-weight: bold;
        }

        .export-modal-close {
            background: none;
            border: none;
            cursor: pointer;
            color: var(--muted-2);
            transition: all 0.3s ease;
        }

        .export-modal-close:hover {
            color: var(--fg);
            transform: rotate(90deg);
        }

        .export-share-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        .share-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            border: 2px solid var(--card-border);
            cursor: pointer;
            transition: all 0.3s ease;
            gap: 10px;
        }

        .share-option:hover {
            transform: translateY(-5px);
            border-color: var(--accent-1);
            box-shadow: 0 10px 20px rgba(139, 92, 246, 0.1);
        }

        .share-option-icon {
            width: 60px;
            height: 60px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .share-option-label {
            font-weight: bold;
            color: var(--fg);
            text-align: center;
        }

        .export-format-options {
            display: flex;
            gap: 10px;
            margin: 20px 0;
        }

        .format-option {
            flex: 1;
            padding: 15px;
            text-align: center;
            border: 2px solid var(--card-border);
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            color: var(--fg);
        }

        .format-option.selected {
            background: linear-gradient(135deg, var(--accent-1), var(--accent-2));
            color: white;
            border-color: var(--accent-1);
        }

        .export-preview {
            background: rgba(139, 92, 246, 0.05);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            max-height: 200px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
            color: var(--fg);
        }

        /* Additional export buttons */
        .export-action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .export-action-btn {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .export-action-btn.primary {
            background: linear-gradient(135deg, var(--accent-1), var(--accent-2));
            color: white;
        }

        .export-action-btn.secondary {
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid var(--card-border);
            color: var(--fg);
        }

        .export-action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        /* Success message */
        .export-success {
            display: none;
            padding: 20px;
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.1), rgba(34, 197, 94, 0.05));
            border: 2px solid rgba(34, 197, 94, 0.3);
            border-radius: 20px;
            margin-top: 20px;
            animation: slideUp 0.3s ease-out;
        }

        .export-success.show {
            display: block;
        }

        .spinning {
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        /* Export loading state */
        .export-loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .export-loading.show {
            display: block;
        }
         /* Share Report Cards */
    .share-report-card {
        padding: 20px;
        background: rgba(255, 255, 255, 0.9);
        border-radius: 20px;
        border: 2px solid var(--card-border);
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .share-report-card:hover {
        transform: translateY(-5px);
        border-color: var(--accent-1);
        box-shadow: 0 10px 20px rgba(139, 92, 246, 0.1);
    }

    .share-report-card.active {
        border-color: var(--accent-1);
        background: rgba(139, 92, 246, 0.05);
    }

    /* Family Member & Doctor Options */
    .family-member-option,
    .doctor-option {
        padding: 10px 16px;
        background: rgba(255, 255, 255, 0.9);
        border: 2px solid var(--card-border);
        border-radius: 12px;
        font-size: 14px;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .family-member-option:hover,
    .doctor-option:hover {
        border-color: var(--accent-1);
        transform: translateY(-2px);
    }

    .family-member-option.selected,
    .doctor-option.selected {
        background: linear-gradient(135deg, var(--accent-1), var(--accent-2));
        color: white;
        border-color: var(--accent-1);
    }

    /* Social Sharing */
    .share-progress-card {
        padding: 25px;
        background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(255, 255, 255, 0.9));
        border-radius: 20px;
        border: 2px solid var(--card-border);
    }

    .social-share-btn {
        width: 100%;
        height: 50px;
        border: none;
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .social-share-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    .social-share-btn i {
        width: 24px;
        height: 24px;
    }

    .mini-badge {
        padding: 4px 10px;
        background: rgba(139, 92, 246, 0.1);
        border-radius: 20px;
        font-size: 12px;
        font-weight: bold;
        color: var(--accent-1);
        white-space: nowrap;
    }

    /* Share Preview Modal */
    .share-preview-modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.8);
        backdrop-filter: blur(10px);
        z-index: 2000;
        justify-content: center;
        align-items: center;
        padding: 20px;
    }

    .share-preview-content {
        background: white;
        border-radius: 25px;
        padding: 30px;
        width: 100%;
        max-width: 500px;
        max-height: 90vh;
        overflow-y: auto;
        animation: slideUp 0.3s ease-out;
    }

    .share-preview-image {
        width: 100%;
        border-radius: 15px;
        margin-bottom: 20px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    }

    .preview-badges {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin: 15px 0;
    }

    .preview-badge {
        padding: 8px 15px;
        background: linear-gradient(135deg, var(--accent-1), var(--accent-2));
        color: white;
        border-radius: 20px;
        font-size: 14px;
        font-weight: bold;
        display: flex;
        align-items: center;
        gap: 5px;
    }

    /* Loading Animation for Sharing */
    .sharing-loading {
        display: none;
        text-align: center;
        padding: 20px;
    }

    .sharing-loading.show {
        display: block;
    }

    .pulse {
        animation: pulse 1.5s infinite;
    }

    /* Success Message */
    .share-success {
        display: none;
        padding: 20px;
        background: linear-gradient(135deg, rgba(34, 197, 94, 0.1), rgba(34, 197, 94, 0.05));
        border: 2px solid rgba(34, 197, 94, 0.3);
        border-radius: 20px;
        margin-top: 20px;
        animation: slideUp 0.3s ease-out;
    }

    .share-success.show {
        display: block;
    }
    </style>
</head>

<body data-theme="neon">
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="user-info">
                <div class="user-avatar" style="background: linear-gradient(135deg, #8B5CF6, #A78BFA);">
                    <i data-lucide="settings"></i>
                </div>
                <div class="greeting">
                    <h1>Settings & Preferences <span class="text-gradient float-animation">‚öôÔ∏è</span></h1>
                    <p><i data-lucide="sliders"></i> Customize your COMPASS experience</p>
                </div>
            </div>

            <!-- Home Icon -->
            <a href="index.html" class="header-settings-icon" aria-label="Home">
                <i data-lucide="home"></i>
            </a>

            <div class="header-controls">
                <button class="btn-secondary" onclick="window.location.href='index.html'">
                    <i data-lucide="arrow-left"></i> Home
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <h1 class="page-title">Personalize Your Experience</h1>

        <!-- Profile Settings -->
        <div class="settings-section">
            <div class="settings-card">
                <h2 style="display: flex; align-items: center; gap: 10px; margin-bottom: 25px; color: var(--fg);">
                    <i data-lucide="user" style="color: var(--accent-1);"></i>
                    Profile Settings
                </h2>

                <div style="display: grid; gap: 20px;">
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: bold; color: var(--fg);">Your
                            Name</label>
                        <input type="text" class="input-field" value="Rohan Choure"
                            style="animation: slideUp 0.3s ease-out;">
                    </div>

                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: bold; color: var(--fg);">Health
                            Conditions</label>
                        <input type="text" class="input-field" value="Hypertension, Type 2 Diabetes"
                            style="animation: slideUp 0.4s ease-out;">
                    </div>

                    <div>
                        <label
                            style="display: block; margin-bottom: 8px; font-weight: bold; color: var(--fg);">Emergency
                            Contact</label>
                        <input type="text" class="input-field" value="Avinash Hugar - (555) 123-4567"
                            style="animation: slideUp 0.5s ease-out;">
                    </div>

                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: bold; color: var(--fg);">Profile
                            Avatar</label>
                        <div class="avatar-grid">
                            <div class="avatar-option selected"
                                style="background: linear-gradient(135deg, #8B5CF6, #A78BFA);"
                                onclick="selectAvatar(this)">üë®</div>
                            <div class="avatar-option" style="background: linear-gradient(135deg, #06B6D4, #38BDF8);"
                                onclick="selectAvatar(this)">üßî</div>
                            <div class="avatar-option" style="background: linear-gradient(135deg, #10B981, #34D399);"
                                onclick="selectAvatar(this)">üë¥</div>
                            <div class="avatar-option" style="background: linear-gradient(135deg, #F59E0B, #FBBF24);"
                                onclick="selectAvatar(this)">üßì</div>
                            <div class="avatar-option" style="background: linear-gradient(135deg, #F97316, #FB7185);"
                                onclick="selectAvatar(this)">üë®‚Äç‚öïÔ∏è</div>
                            <div class="avatar-option" style="background: linear-gradient(135deg, #EF4444, #F87171);"
                                onclick="selectAvatar(this)">ü¶∏</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Theme & Appearance -->
        <div class="settings-section">
            <div class="settings-card">
                <h2 style="display: flex; align-items: center; gap: 10px; margin-bottom: 25px; color: var(--fg);">
                    <i data-lucide="palette" style="color: var(--accent-2);"></i>
                    Theme & Appearance
                </h2>

                <div style="margin-bottom: 25px;">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <div>
                            <div style="font-weight: bold; color: var(--fg);">Theme Selection</div>
                            <div style="color: var(--muted-2); font-size: 14px;">Choose your favorite color scheme</div>
                        </div>
                        <select class="btn-secondary" id="theme-select">
                            <option value="neon">Neon</option>
                            <option value="pastel">Pastel</option>
                            <option value="contrast">High Contrast</option>
                        </select>
                    </div>

                    <div style="display: flex; gap: 15px; margin-top: 20px;">
                        <div class="color-option selected"
                            style="background: linear-gradient(135deg, #8B5CF6, #06B6D4, #F97316);"
                            onclick="selectColor(this)" title="Neon"></div>
                        <div class="color-option"
                            style="background: linear-gradient(135deg, #A78BFA, #38BDF8, #FB7185);"
                            onclick="selectColor(this)" title="Pastel"></div>
                        <div class="color-option"
                            style="background: linear-gradient(135deg, #0066FF, #00D4AA, #FF6B00);"
                            onclick="selectColor(this)" title="High Contrast"></div>
                    </div>
                </div>

                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <div>
                        <div style="font-weight: bold; color: var(--fg);">Animations</div>
                        <div style="color: var(--muted-2); font-size: 14px;">Playful animations & effects</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" checked onclick="toggleAnimations(this)">
                        <span class="toggle-slider"></span>
                    </label>
                </div>

                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <div style="font-weight: bold; color: var(--fg);">Confetti Effects</div>
                        <div style="color: var(--muted-2); font-size: 14px;">Celebrate achievements with confetti</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" checked onclick="toggleConfetti(this)">
                        <span class="toggle-slider"></span>
                    </label>
                </div>
            </div>
        </div>

        <!-- Notifications -->
        <div class="settings-section">
            <div class="settings-card">
                <h2 style="display: flex; align-items: center; gap: 10px; margin-bottom: 25px; color: var(--fg);">
                    <i data-lucide="bell" style="color: var(--warn);"></i>
                    Notifications
                </h2>

                <div style="margin-bottom: 20px;">
                    <div class="notification-item">
                        <div>
                            <div style="font-weight: bold; color: var(--fg);">Medication Reminders</div>
                            <div style="color: var(--muted-2); font-size: 14px;">Get notified when it's time for
                                medication</div>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>

                    <div class="notification-item">
                        <div>
                            <div style="font-weight: bold; color: var(--fg);">Task Reminders</div>
                            <div style="color: var(--muted-2); font-size: 14px;">Reminders for scheduled health tasks
                            </div>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>

                    <div class="notification-item">
                        <div>
                            <div style="font-weight: bold; color: var(--fg);">Achievement Alerts</div>
                            <div style="color: var(--muted-2); font-size: 14px;">Celebrate when you earn badges or level
                                up</div>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>

                    <div class="notification-item">
                        <div>
                            <div style="font-weight: bold; color: var(--fg);">Health Tips</div>
                            <div style="color: var(--muted-2); font-size: 14px;">Daily health tips and recommendations
                            </div>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>

                <div
                    style="color: var(--muted-2); font-size: 14px; padding: 15px; background: rgba(139, 92, 246, 0.1); border-radius: 15px;">
                    <i data-lucide="info" style="margin-right: 8px;"></i>
                    Notifications are sent at appropriate times to avoid disturbance
                </div>
            </div>
        </div>

        <!-- Data & Privacy -->
        <div class="settings-section">
            <div class="settings-card">
                <h2 style="display: flex; align-items: center; gap: 10px; margin-bottom: 25px; color: var(--fg);">
                    <i data-lucide="shield" style="color: var(--ok);"></i>
                    Data & Privacy
                </h2>

                <div style="margin-bottom: 20px;">
                    <div class="export-option" onclick="showExportModal('health')">
                        <div style="display: flex; align-items: center; gap: 15px;">
                            <div
                                style="width: 50px; height: 50px; background: linear-gradient(135deg, #8B5CF6, #A78BFA); border-radius: 12px; display: flex; align-items: center; justify-content: center;">
                                <i data-lucide="activity" style="color: white;"></i>
                            </div>
                            <div>
                                <div style="font-weight: bold; color: var(--fg);">Export Health Data</div>
                                <div style="color: var(--muted-2); font-size: 14px;">Download your complete health
                                    history in ABDM format</div>
                            </div>
                        </div>
                    </div>

                    <div class="export-option" onclick="showExportModal('medication')">
                        <div style="display: flex; align-items: center; gap: 15px;">
                            <div
                                style="width: 50px; height: 50px; background: linear-gradient(135deg, #06B6D4, #38BDF8); border-radius: 12px; display: flex; align-items: center; justify-content: center;">
                                <i data-lucide="pill" style="color: white;"></i>
                            </div>
                            <div>
                                <div style="font-weight: bold; color: var(--fg);">Export Medication History</div>
                                <div style="color: var(--muted-2); font-size: 14px;">Detailed report of all medications
                                    taken</div>
                            </div>
                        </div>
                    </div>

                    <div class="export-option" onclick="showExportModal('progress')">
                        <div style="display: flex; align-items: center; gap: 15px;">
                            <div
                                style="width: 50px; height: 50px; background: linear-gradient(135deg, #10B981, #34D399); border-radius: 12px; display: flex; align-items: center; justify-content: center;">
                                <i data-lucide="trending-up" style="color: white;"></i>
                            </div>
                            <div>
                                <div style="font-weight: bold; color: var(--fg);">Export Progress Report</div>
                                <div style="color: var(--muted-2); font-size: 14px;">Comprehensive progress analytics
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <div>
                        <div style="font-weight: bold; color: var(--fg);">Data Sharing with Doctor</div>
                        <div style="color: var(--muted-2); font-size: 14px;">Allow your doctor to view your progress
                        </div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" checked>
                        <span class="toggle-slider"></span>
                    </label>
                </div>

                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <div style="font-weight: bold; color: var(--fg);">Anonymous Data for Research</div>
                        <div style="color: var(--muted-2); font-size: 14px;">Help improve COMPASS for everyone</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox">
                        <span class="toggle-slider"></span>
                    </label>
                </div>
            </div>
        </div>
<!-- Share & Notifications -->
<div class="settings-section">
    <div class="settings-card">
        <h2 style="display: flex; align-items: center; gap: 10px; margin-bottom: 25px; color: var(--fg);">
            <i data-lucide="share-2" style="color: #8B5CF6;"></i>
            Share & Notifications
        </h2>

        <!-- Family & Doctor Report Sharing -->
        <div style="margin-bottom: 30px;">
            <h3 style="color: var(--fg); margin-bottom: 15px; font-size: 18px;">Send Health Reports</h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                <div class="share-report-card" onclick="sendFamilyReport()">
                    <div style="display: flex; align-items: center; gap: 15px;">
                        <div
                            style="width: 60px; height: 60px; background: linear-gradient(135deg, #06B6D4, #38BDF8); border-radius: 12px; display: flex; align-items: center; justify-content: center;">
                            <i data-lucide="heart" style="color: white;"></i>
                        </div>
                        <div style="flex: 1;">
                            <div style="font-weight: bold; color: var(--fg);">Send to Family</div>
                            <div style="color: var(--muted-2); font-size: 14px;">Share summary with emergency contact
                            </div>
                        </div>
                        <i data-lucide="send" style="color: var(--muted-2);"></i>
                    </div>
                    <div class="report-preview" style="display: none;">
                        <div style="font-size: 12px; color: var(--muted-2); margin-top: 10px;">
                            ‚úÖ All tasks completed today<br>
                            üíä Medications taken on time<br>
                            üìà Vital signs stable<br>
                            üéØ Daily goals achieved
                        </div>
                    </div>
                </div>

                <div class="share-report-card" onclick="sendDoctorReport()">
                    <div style="display: flex; align-items: center; gap: 15px;">
                        <div
                            style="width: 60px; height: 60px; background: linear-gradient(135deg, #10B981, #34D399); border-radius: 12px; display: flex; align-items: center; justify-content: center;">
                            <i data-lucide="stethoscope" style="color: white;"></i>
                        </div>
                        <div style="flex: 1;">
                            <div style="font-weight: bold; color: var(--fg);">Send to Doctor</div>
                            <div style="color: var(--muted-2); font-size: 14px;">Share detailed report with healthcare
                                provider</div>
                        </div>
                        <i data-lucide="send" style="color: var(--muted-2);"></i>
                    </div>
                    <div class="report-preview" style="display: none;">
                        <div style="font-size: 12px; color: var(--muted-2); margin-top: 10px;">
                            üìä Detailed vitals history<br>
                            üíä Medication adherence: 95%<br>
                            üìà Trends & analytics<br>
                            üìù Notes & observations
                        </div>
                    </div>
                </div>
            </div>

            <!-- Family Member Selection -->
            <div id="familyMembersSection" style="display: none; margin-top: 20px;">
                <div style="margin-bottom: 10px; font-weight: bold; color: var(--fg);">Select Family Member</div>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <div class="family-member-option selected" onclick="selectFamilyMember(this, 'avinash')">
                        <i data-lucide="user" style="width: 16px; height: 16px;"></i>
                        Avinash (Primary)
                    </div>
                    <div class="family-member-option" onclick="selectFamilyMember(this, 'priya')">
                        <i data-lucide="user" style="width: 16px; height: 16px;"></i>
                        Priya
                    </div>
                    <div class="family-member-option" onclick="selectFamilyMember(this, 'raj')">
                        <i data-lucide="user" style="width: 16px; height: 16px;"></i>
                        Raj
                    </div>
                    <button class="btn-secondary" style="padding: 8px 12px; font-size: 12px;"
                        onclick="addNewFamilyMember()">
                        <i data-lucide="plus" style="width: 12px; height: 12px;"></i> Add
                    </button>
                </div>
            </div>

            <!-- Doctor Selection -->
            <div id="doctorsSection" style="display: none; margin-top: 20px;">
                <div style="margin-bottom: 10px; font-weight: bold; color: var(--fg);">Select Doctor</div>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <div class="doctor-option selected" onclick="selectDoctor(this, 'dr_sharma')">
                        <i data-lucide="stethoscope" style="width: 16px; height: 16px;"></i>
                        Dr. Sharma
                    </div>
                    <div class="doctor-option" onclick="selectDoctor(this, 'dr_patel')">
                        <i data-lucide="stethoscope" style="width: 16px; height: 16px;"></i>
                        Dr. Patel
                    </div>
                    <button class="btn-secondary" style="padding: 8px 12px; font-size: 12px;"
                        onclick="addNewDoctor()">
                        <i data-lucide="plus" style="width: 12px; height: 12px;"></i> Add Doctor
                    </button>
                </div>
            </div>
        </div>

        <!-- Social Media Sharing -->
        <div>
            <h3 style="color: var(--fg); margin-bottom: 15px; font-size: 18px;">Share Progress on Social Media</h3>
            <div class="share-progress-card">
                <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 20px;">
                    <div
                        style="width: 70px; height: 70px; background: linear-gradient(135deg, #8B5CF6, #EC4899); border-radius: 15px; display: flex; align-items: center; justify-content: center; position: relative;">
                        <i data-lucide="trophy" style="color: white; font-size: 32px;"></i>
                        <div style="position: absolute; bottom: -5px; right: -5px; background: #F59E0B; color: white; width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: bold;">
                            5
                        </div>
                    </div>
                    <div style="flex: 1;">
                        <div style="font-weight: bold; color: var(--fg); font-size: 18px;">My Health Journey</div>
                        <div style="color: var(--muted-2); font-size: 14px;">Level 8 ‚Ä¢ 28-day streak ‚Ä¢ 15 badges</div>
                        <div style="display: flex; gap: 10px; margin-top: 8px;">
                            <div class="mini-badge">üèÜ Consistency</div>
                            <div class="mini-badge">üí™ Strength</div>
                            <div class="mini-badge">üéØ Focus</div>
                        </div>
                    </div>
                </div>

                <!-- Share Buttons -->
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 15px;">
                    <button class="social-share-btn" onclick="shareOnFacebook()"
                        style="background: linear-gradient(135deg, #1877F2, #0D5FDB);">
                        <i data-lucide="facebook" style="color: white;"></i>
                    </button>
                    <button class="social-share-btn" onclick="shareOnTwitter()"
                        style="background: linear-gradient(135deg, #1DA1F2, #0D8BD9);">
                        <i data-lucide="twitter" style="color: white;"></i>
                    </button>
                    <button class="social-share-btn" onclick="shareOnInstagram()"
                        style="background: linear-gradient(135deg, #E4405F, #C13584);">
                        <i data-lucide="instagram" style="color: white;"></i>
                    </button>
                    <button class="social-share-btn" onclick="shareOnLinkedIn()"
                        style="background: linear-gradient(135deg, #0A66C2, #004182);">
                        <i data-lucide="linkedin" style="color: white;"></i>
                    </button>
                </div>

                <!-- Custom Message -->
                <div style="margin-top: 15px;">
                    <div style="font-weight: bold; color: var(--fg); margin-bottom: 8px; font-size: 14px;">Custom
                        Message</div>
                    <textarea id="shareMessage" class="input-field" placeholder="Check out my health journey progress! üéØüí™"
                        style="height: 80px; resize: none;">I've been taking care of my health with COMPASS! Level 8 with a 28-day streak! üèÜüí™ #HealthJourney #COMPASSHealth</textarea>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 10px;">
                        <div style="font-size: 12px; color: var(--muted-2);">
                            <i data-lucide="info" style="width: 12px; height: 12px;"></i>
                            Your personal health data remains private
                        </div>
                        <button class="btn-primary" style="padding: 10px 20px; font-size: 14px;"
                            onclick="generateShareImage()">
                            <i data-lucide="image"></i> Create Share Image
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

        <!-- Danger Zone -->
        <div class="settings-section">
            <div class="settings-card danger-zone">
                <h2 style="display: flex; align-items: center; gap: 10px; margin-bottom: 25px; color: #EF4444;">
                    <i data-lucide="alert-triangle" style="color: #EF4444;"></i>
                    Danger Zone
                </h2>

                <div style="margin-bottom: 20px;">
                    <div
                        style="padding: 20px; background: rgba(239, 68, 68, 0.1); border-radius: 15px; margin-bottom: 15px;">
                        <div style="font-weight: bold; color: #EF4444; margin-bottom: 5px;">Reset All Data</div>
                        <div style="color: #EF4444; font-size: 14px; opacity: 0.8;">This will delete all your progress,
                            badges, and settings</div>
                    </div>

                    <div style="padding: 20px; background: rgba(239, 68, 68, 0.1); border-radius: 15px;">
                        <div style="font-weight: bold; color: #EF4444; margin-bottom: 5px;">Delete Account</div>
                        <div style="color: #EF4444; font-size: 14px; opacity: 0.8;">Permanently delete your COMPASS
                            account</div>
                    </div>
                </div>

                <div style="display: flex; gap: 15px;">
                    <button class="btn-secondary" onclick="resetData()"
                        style="background: rgba(239, 68, 68, 0.1); color: #EF4444; border-color: #EF4444;">
                        <i data-lucide="refresh-cw"></i> Reset Data
                    </button>
                    <button class="btn-secondary" onclick="deleteAccount()"
                        style="background: rgba(239, 68, 68, 0.2); color: #EF4444; border-color: #EF4444;">
                        <i data-lucide="trash-2"></i> Delete Account
                    </button>
                </div>
            </div>
        </div>

        <!-- About COMPASS -->
        <div class="settings-section">
            <div class="settings-card">
                <h2 style="display: flex; align-items: center; gap: 10px; margin-bottom: 25px; color: var(--fg);">
                    <i data-lucide="info" style="color: var(--accent-3);"></i>
                    About COMPASS
                </h2>

                <div style="margin-bottom: 20px;">
                    <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 20px;">
                        <div
                            style="width: 60px; height: 60px; background: linear-gradient(135deg, #8B5CF6, #06B6D4, #F97316); border-radius: 15px; display: flex; align-items: center; justify-content: center;">
                            <i data-lucide="compass" style="color: white;"></i>
                        </div>
                        <div>
                            <div style="font-weight: bold; color: var(--fg);">COMPASS Health</div>
                            <div style="color: var(--muted-2);">Version 5.0 ‚Ä¢ Build 2024.12</div>
                        </div>
                    </div>

                    <div style="color: var(--muted-2); line-height: 1.6; margin-bottom: 20px;">
                        COMPASS is your personal health companion that makes managing your health fun and rewarding
                        through gamification and intuitive design.
                    </div>
                </div>

                <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                    <button class="btn-secondary" onclick="window.location.href='about.html'">
                        <i data-lucide="book-open"></i> About Us
                    </button>
                    <button class="btn-secondary" onclick="window.location.href='contact.html'">
                        <i data-lucide="phone"></i> Contact Support
                    </button>
                    <button class="btn-secondary" onclick="window.location.href='feedback.html'">
                        <i data-lucide="message-square"></i> Send Feedback
                    </button>
                </div>
            </div>
        </div>

        <!-- Save Button -->
        <div style="text-align: center; margin: 40px 0;">
            <button class="btn-primary" style="padding: 20px 40px; font-size: 18px;" onclick="saveSettings()">
                <i data-lucide="save"></i> Save All Changes
            </button>
        </div>
    </main>

    <!-- Export Modal -->
    <div id="exportModal" class="export-modal">
        <div class="export-modal-content">
            <div class="export-modal-header">
                <div class="export-modal-title">
                    <i data-lucide="download" id="exportModalIcon"></i>
                    <span id="exportModalTitle">Export Data</span>
                </div>
                <button class="export-modal-close" onclick="closeExportModal()">
                    <i data-lucide="x"></i>
                </button>
            </div>

            <div id="exportModalBody">
                <!-- Format selection will be inserted here -->
            </div>

            <div class="export-action-buttons">
                <button class="export-action-btn secondary" onclick="downloadExport()">
                    <i data-lucide="download"></i> Download
                </button>
                <button class="export-action-btn primary" onclick="shareExport()">
                    <i data-lucide="share-2"></i> Share
                </button>
            </div>

            <div class="export-loading" id="exportLoading">
                <div style="margin-bottom: 15px;">
                    <i data-lucide="loader" class="spinning" style="font-size: 32px; color: var(--accent-1);"></i>
                </div>
                <div style="font-weight: bold; color: var(--fg);">Preparing your export...</div>
                <div style="color: var(--muted-2); font-size: 14px;">This may take a few seconds</div>
            </div>

            <div class="export-success" id="exportSuccess">
                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                    <i data-lucide="check-circle" style="color: var(--ok);"></i>
                    <div style="font-weight: bold; color: var(--fg);">Export Successful!</div>
                </div>
                <div style="color: var(--muted-2); font-size: 14px;">
                    Your data has been exported successfully. You can now share it using the options below.
                </div>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <a href="index.html" class="nav-item">
            <i data-lucide="home"></i>
            <span>Home</span>
        </a>
        <a href="todo.html" class="nav-item">
            <i data-lucide="list-checks"></i>
            <span>To-Do</span>
        </a>

        <div class="sos-button" onmousedown="startSOSCountdown()"
            onmouseup='this.innerHTML = "<i data-lucide=\"siren\"></i>"' ontouchstart="startSOSCountdown()"
            ontouchend='this.innerHTML = "<i data-lucide=\" siren\"></i>"'>
            <i data-lucide="siren"></i>
        </div>

        <a href="progress.html" class="nav-item">
            <i data-lucide="trending-up"></i>
            <span>Progress</span>
        </a>
        <a href="settings.html" class="nav-item active">
            <i data-lucide="settings"></i>
            <span>Settings</span>
        </a>
    </nav>

    <script>
        // Settings page functionality
        let currentAvatar = 0;
        let animationsEnabled = true;
        let confettiEnabled = true;
        let currentExportType = '';
        let currentExportFormat = 'json';

        // Export data samples (in real app, this would come from database)
        const exportDataSamples = {
            health: {
                title: 'Health Data',
                icon: 'activity',
                json: {
                    patient: "Rohan Choure",
                    conditions: ["Hypertension", "Type 2 Diabetes"],
                    vitals: [
                        { date: "2024-12-01", bp: "130/85", glucose: "145", weight: "78kg" },
                        { date: "2024-12-02", bp: "128/82", glucose: "138", weight: "77.5kg" },
                        { date: "2024-12-03", bp: "125/80", glucose: "132", weight: "77kg" }
                    ],
                    last_updated: new Date().toISOString()
                },
                csv: "Date,Blood Pressure,Glucose,Weight\n2024-12-01,130/85,145,78kg\n2024-12-02,128/82,138,77.5kg\n2024-12-03,125/80,132,77kg"
            },
            medication: {
                title: 'Medication History',
                icon: 'pill',
                json: {
                    patient: "Rohan Choure",
                    medications: [
                        { name: "Metformin", dosage: "500mg", frequency: "Twice daily", start_date: "2024-01-15" },
                        { name: "Lisinopril", dosage: "10mg", frequency: "Once daily", start_date: "2024-02-10" },
                        { name: "Atorvastatin", dosage: "20mg", frequency: "Once daily", start_date: "2024-03-05" }
                    ],
                    adherence_rate: "94%",
                    last_updated: new Date().toISOString()
                },
                csv: "Medication,Dosage,Frequency,Start Date\nMetformin,500mg,Twice daily,2024-01-15\nLisinopril,10mg,Once daily,2024-02-10\nAtorvastatin,20mg,Once daily,2024-03-05"
            },
            progress: {
                title: 'Progress Report',
                icon: 'trending-up',
                json: {
                    patient: "Rohan Choure",
                    period: "December 2024",
                    achievements: [
                        { badge: "Consistency Champion", earned: "2024-12-15" },
                        { badge: "Glucose Guru", earned: "2024-12-20" },
                        { badge: "Medication Master", earned: "2024-12-25" }
                    ],
                    stats: {
                        tasks_completed: 45,
                        streak_days: 28,
                        glucose_improvement: "18%",
                        weight_loss: "2.5kg"
                    },
                    last_updated: new Date().toISOString()
                },
                csv: "Metric,Value\nTasks Completed,45\nStreak Days,28\nGlucose Improvement,18%\nWeight Loss,2.5kg"
            }
        };

        function selectAvatar(avatarElement) {
            document.querySelectorAll('.avatar-option').forEach(avatar => {
                avatar.classList.remove('selected');
            });

            avatarElement.classList.add('selected');
            const avatars = Array.from(document.querySelectorAll('.avatar-option'));
            currentAvatar = avatars.indexOf(avatarElement);

            avatarElement.classList.add('wiggle');
            setTimeout(() => {
                avatarElement.classList.remove('wiggle');
            }, 500);

            const userAvatar = document.querySelector('.user-avatar');
            if (userAvatar) {
                userAvatar.innerHTML = avatarElement.textContent;
            }
        }

        function selectColor(colorElement) {
            document.querySelectorAll('.color-option').forEach(color => {
                color.classList.remove('selected');
            });

            colorElement.classList.add('selected');
            const scheme = colorElement.getAttribute('title').toLowerCase();
            if (scheme) {
                document.body.setAttribute('data-theme', scheme);
                document.getElementById('theme-select').value = scheme;
                localStorage.setItem('compassTheme', scheme);

                colorElement.style.transform = 'scale(1.3)';
                setTimeout(() => {
                    colorElement.style.transform = 'scale(1.2)';
                }, 300);
            }
        }

        function toggleAnimations(checkbox) {
            animationsEnabled = checkbox.checked;
            if (!animationsEnabled) {
                document.body.classList.add('no-animations');
                alert('Animations disabled. Page will feel faster but less playful!');
            } else {
                document.body.classList.remove('no-animations');
                alert('Animations enabled! Enjoy the playful experience! üéâ');
            }
        }

        function toggleConfetti(checkbox) {
            confettiEnabled = checkbox.checked;
            if (confettiEnabled) {
                alert('Confetti enabled! Get ready for celebrations! üéä');
            } else {
                alert('Confetti disabled. Quiet mode activated.');
            }
        }

        function showExportModal(type) {
            currentExportType = type;
            const exportData = exportDataSamples[type];
            
            if (!exportData) return;

            // Update modal title and icon
            document.getElementById('exportModalTitle').textContent = `Export ${exportData.title}`;
            document.getElementById('exportModalIcon').setAttribute('data-lucide', exportData.icon);
            
            // Create modal body content
            const modalBody = document.getElementById('exportModalBody');
            modalBody.innerHTML = `
                <div style="color: var(--muted-2); margin-bottom: 20px;">
                    Select format and preview your ${exportData.title.toLowerCase()}
                </div>
                
                <div class="export-format-options">
                    <div class="format-option ${currentExportFormat === 'json' ? 'selected' : ''}" 
                         onclick="selectExportFormat('json')">
                        JSON
                    </div>
                    <div class="format-option ${currentExportFormat === 'csv' ? 'selected' : ''}" 
                         onclick="selectExportFormat('csv')">
                        CSV
                    </div>
                    <div class="format-option ${currentExportFormat === 'abdm' ? 'selected' : ''}" 
                         onclick="selectExportFormat('abdm')">
                        ABDM
                    </div>
                </div>
                
                <div class="export-preview" id="exportPreview">
                    ${getExportPreview(type, currentExportFormat)}
                </div>
                
                <div class="export-share-options" id="shareOptions" style="display: none;">
                    <div class="share-option" onclick="shareViaABDM()">
                        <div class="share-option-icon" style="background: linear-gradient(135deg, #3B82F6, #60A5FA);">
                            <i data-lucide="shield"></i>
                        </div>
                        <div class="share-option-label">ABDM</div>
                    </div>
                    <div class="share-option" onclick="shareViaWhatsApp()">
                        <div class="share-option-icon" style="background: linear-gradient(135deg, #25D366, #128C7E);">
                            <i data-lucide="message-circle"></i>
                        </div>
                        <div class="share-option-label">WhatsApp</div>
                    </div>
                    <div class="share-option" onclick="shareViaEmail()">
                        <div class="share-option-icon" style="background: linear-gradient(135deg, #EA4335, #FBBC05);">
                            <i data-lucide="mail"></i>
                        </div>
                        <div class="share-option-label">Email</div>
                    </div>
                    <div class="share-option" onclick="shareViaSMS()">
                        <div class="share-option-icon" style="background: linear-gradient(135deg, #34B7F1, #075E54);">
                            <i data-lucide="smartphone"></i>
                        </div>
                        <div class="share-option-label">SMS</div>
                    </div>
                </div>
            `;

            // Show modal
            document.getElementById('exportModal').style.display = 'flex';
            
            // Refresh Lucide icons
            if (window.lucide) {
                lucide.createIcons();
            }
        }

        function closeExportModal() {
            document.getElementById('exportModal').style.display = 'none';
            document.getElementById('exportSuccess').classList.remove('show');
            document.getElementById('shareOptions').style.display = 'none';
        }

        function selectExportFormat(format) {
            currentExportFormat = format;
            
            // Update format selection UI
            document.querySelectorAll('.format-option').forEach(option => {
                option.classList.remove('selected');
            });
            document.querySelectorAll('.format-option')[['json', 'csv', 'abdm'].indexOf(format)].classList.add('selected');
            
            // Update preview
            document.getElementById('exportPreview').innerHTML = getExportPreview(currentExportType, format);
        }

        function getExportPreview(type, format) {
            const data = exportDataSamples[type];
            if (!data) return 'No data available';
            
            switch(format) {
                case 'json':
                    return `<pre>${JSON.stringify(data.json, null, 2)}</pre>`;
                case 'csv':
                    return `<pre>${data.csv}</pre>`;
                case 'abdm':
                    return `<pre>ABDM Format - FHIR Compliant\n\nPatient: ${data.json.patient}\nDate: ${new Date().toLocaleDateString()}\nFormat: JSON-LD with Digital Signature</pre>`;
                default:
                    return 'Format not supported';
            }
        }

        function downloadExport() {
            const exportData = exportDataSamples[currentExportType];
            if (!exportData) return;

            // Show loading
            document.getElementById('exportLoading').classList.add('show');
            
            setTimeout(() => {
                // Hide loading
                document.getElementById('exportLoading').classList.remove('show');
                
                // Create download based on format
                let content, filename, mimeType;
                
                switch(currentExportFormat) {
                    case 'json':
                        content = JSON.stringify(exportData.json, null, 2);
                        filename = `COMPASS_${currentExportType}_${new Date().toISOString().split('T')[0]}.json`;
                        mimeType = 'application/json';
                        break;
                    case 'csv':
                        content = exportData.csv;
                        filename = `COMPASS_${currentExportType}_${new Date().toISOString().split('T')[0]}.csv`;
                        mimeType = 'text/csv';
                        break;
                    case 'abdm':
                        content = JSON.stringify({
                            ...exportData.json,
                            format: "ABDM_FHIR",
                            signature: "DIGITAL_SIGNATURE_PLACEHOLDER",
                            timestamp: new Date().toISOString()
                        }, null, 2);
                        filename = `COMPASS_${currentExportType}_ABDM_${new Date().toISOString().split('T')[0]}.json`;
                        mimeType = 'application/json';
                        break;
                }

                // Create and trigger download
                const blob = new Blob([content], { type: mimeType });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);

                // Show success message and share options
                document.getElementById('exportSuccess').classList.add('show');
                document.getElementById('shareOptions').style.display = 'grid';
                
                // Show notification
                alert(`‚úÖ ${exportData.title} downloaded successfully as ${currentExportFormat.toUpperCase()}!`);
            }, 1500);
        }

        function shareExport() {
            const exportData = exportDataSamples[currentExportType];
            if (!exportData) return;

            // Show share options
            document.getElementById('shareOptions').style.display = 'grid';
            document.getElementById('exportSuccess').classList.add('show');
            
            // Scroll to share options
            document.getElementById('shareOptions').scrollIntoView({ behavior: 'smooth' });
        }

        function shareViaABDM() {
            alert(`üîê Sharing ${exportDataSamples[currentExportType].title} via ABDM (Ayushman Bharat Digital Mission)...\n\nThis would integrate with the ABDM ecosystem for secure health data sharing.`);
        }

        function shareViaWhatsApp() {
            const message = `Here's my ${exportDataSamples[currentExportType].title} from COMPASS Health:\n\n${window.location.href}`;
            const url = `https://wa.me/?text=${encodeURIComponent(message)}`;
            window.open(url, '_blank');
        }

        function shareViaEmail() {
            const subject = `My ${exportDataSamples[currentExportType].title} from COMPASS Health`;
            const body = `Attached is my ${exportDataSamples[currentExportType].title} exported from COMPASS Health.\n\nGenerated on: ${new Date().toLocaleDateString()}`;
            window.location.href = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
        }

        function shareViaSMS() {
            alert(`üì± SMS sharing would send your ${exportDataSamples[currentExportType].title} via text message.\n\nNote: Large files may be truncated in SMS.`);
        }

        function resetData() {
            if (confirm('‚ö†Ô∏è Are you sure you want to reset ALL data?\n\nThis will delete all your progress, badges, and settings. This action cannot be undone!')) {
                if (confirm('üö® LAST WARNING: This will permanently delete:\n‚Ä¢ All health data\n‚Ä¢ Progress and achievements\n‚Ä¢ Game stats and badges\n‚Ä¢ Custom settings\n\nType "RESET" to confirm:')) {
                    const userInput = prompt('Type "RESET" to confirm:');
                    if (userInput === 'RESET') {
                        alert('üßπ Resetting all data...');
                        setTimeout(() => {
                            alert('‚úÖ All data has been reset. The page will now refresh.');
                            window.location.reload();
                        }, 2000);
                    }
                }
            }
        }

        function deleteAccount() {
            alert('üö® Account deletion is a serious action.\n\nPlease contact support at support@compass.health for account deletion requests.');
        }

        function saveSettings() {
            const saveBtn = document.querySelector('.btn-primary');
            const originalText = saveBtn.innerHTML;
            saveBtn.innerHTML = '<i data-lucide="loader" class="spinning"></i> Saving...';
            saveBtn.disabled = true;

            setTimeout(() => {
                saveBtn.innerHTML = '<i data-lucide="check-circle"></i> Saved Successfully!';
                saveBtn.style.background = 'linear-gradient(135deg, var(--ok), #34D399)';

                if (confettiEnabled) {
                    triggerConfetti();
                }

                setTimeout(() => {
                    saveBtn.innerHTML = originalText;
                    saveBtn.style.background = '';
                    saveBtn.disabled = false;
                    alert('‚úÖ All settings saved successfully!');
                }, 2000);
            }, 1500);
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function () {
            // Add animations to settings cards
            document.querySelectorAll('.settings-card').forEach((card, index) => {
                card.style.animationDelay = `${index * 0.1}s`;
            });

            // Add click animations to interactive elements
            document.querySelectorAll('.avatar-option, .color-option, .export-option').forEach(element => {
                element.addEventListener('click', function () {
                    this.style.transform = 'scale(0.95)';
                    setTimeout(() => {
                        this.style.transform = '';
                    }, 150);
                });
            });

            // Initialize theme from localStorage
            const savedTheme = localStorage.getItem('compassTheme') || 'neon';
            document.body.setAttribute('data-theme', savedTheme);
            document.getElementById('theme-select').value = savedTheme;

            // Select corresponding color option
            const colorOptions = document.querySelectorAll('.color-option');
            colorOptions.forEach(option => {
                if (option.getAttribute('title').toLowerCase() === savedTheme) {
                    option.classList.add('selected');
                }
            });

            // Theme selector change handler
            document.getElementById('theme-select').addEventListener('change', function() {
                const theme = this.value;
                document.body.setAttribute('data-theme', theme);
                localStorage.setItem('compassTheme', theme);
                
                // Update selected color option
                colorOptions.forEach(option => {
                    option.classList.remove('selected');
                    if (option.getAttribute('title').toLowerCase() === theme) {
                        option.classList.add('selected');
                    }
                });
            });
        });

        // Confetti function (placeholder)
        function triggerConfetti() {
            console.log('üéä Confetti would trigger here!');
            // In a real implementation, you would use a confetti library
        }
    </script>
    <script>
    // Share & Notifications functionality
    let selectedFamilyMember = 'avinash';
    let selectedDoctor = 'dr_sharma';
    let isSendingReport = false;

    // Report data (in real app, this would come from your database)
    const reportData = {
        family: {
            title: "Daily Health Summary",
            icon: "heart",
            content: `
                üë§ Patient: Rohan Choure
                üìÖ Date: ${new Date().toLocaleDateString()}
                
                ‚úÖ Today's Progress:
                ‚Ä¢ All 6 tasks completed
                ‚Ä¢ Medications taken on time
                ‚Ä¢ 30-min walk completed
                ‚Ä¢ Vitals within normal range
                
                üèÜ Achievements:
                ‚Ä¢ 28-day streak maintained
                ‚Ä¢ Earned "Consistency Champion" badge
                ‚Ä¢ Level 8 reached
                
                üí¨ Message:
                "Feeling great and staying on track with my health goals!"
                
                üö® Emergency Info:
                ‚Ä¢ Conditions: Hypertension, Type 2 Diabetes
                ‚Ä¢ Last BP: 128/82 mmHg
                ‚Ä¢ Last Glucose: 138 mg/dL
            `,
            contacts: {
                avinash: { name: "Avinash Hugar", phone: "(555) 123-4567" },
                priya: { name: "Priya Sharma", phone: "(555) 987-6543" },
                raj: { name: "Raj Patel", phone: "(555) 456-7890" }
            }
        },
        doctor: {
            title: "Clinical Progress Report",
            icon: "stethoscope",
            content: `
                üë§ Patient: Rohan Choure (ID: COMPASS-PT-2024-001)
                üìÖ Period: ${new Date().toLocaleDateString()}
                
                üìä Vital Signs History:
                ‚Ä¢ Blood Pressure: 128/82 mmHg (Avg: 130/85)
                ‚Ä¢ Glucose Levels: 138 mg/dL (Avg: 142)
                ‚Ä¢ Weight: 77.5kg (Trend: -2.5kg in 30 days)
                
                üíä Medication Adherence:
                ‚Ä¢ Metformin 500mg: 100% adherence (30/30 doses)
                ‚Ä¢ Lisinopril 10mg: 100% adherence (30/30 doses)
                ‚Ä¢ Atorvastatin 20mg: 95% adherence (28/30 doses)
                
                üìà Trends & Observations:
                ‚Ä¢ Consistent improvement in glucose control
                ‚Ä¢ Stable blood pressure readings
                ‚Ä¢ Good exercise adherence (85% completion rate)
                
                üéØ Recommendations for Next Visit:
                ‚Ä¢ Continue current medication regimen
                ‚Ä¢ Consider reducing Metformin if trend continues
                ‚Ä¢ Schedule follow-up in 2 weeks
                
                üîê Security Note:
                ‚Ä¢ Report digitally signed: COMPASS-SIG-${Date.now()}
                ‚Ä¢ HIPAA compliant transmission
            `,
            doctors: {
                dr_sharma: { name: "Dr. Sharma", specialty: "Cardiology", contact: "clinic@drsharma.com" },
                dr_patel: { name: "Dr. Patel", specialty: "Endocrinology", contact: "info@drpatelclinic.com" }
            }
        }
    };

    function sendFamilyReport() {
        if (isSendingReport) return;
        
        const card = event.target.closest('.share-report-card');
        card.classList.add('active');
        
        // Show family member selection
        document.getElementById('familyMembersSection').style.display = 'block';
        document.getElementById('doctorsSection').style.display = 'none';
        
        // Show preview
        const preview = card.querySelector('.report-preview');
        preview.style.display = 'block';
        
        setTimeout(() => {
            const confirmSend = confirm(`Send daily health summary to ${reportData.family.contacts[selectedFamilyMember].name}?\n\nThis will share your progress and current status.`);
            
            if (confirmSend) {
                isSendingReport = true;
                showSharingLoading('family');
                
                setTimeout(() => {
                    // Simulate sending
                    const success = Math.random() > 0.1; // 90% success rate
                    
                    if (success) {
                        showShareSuccess(`‚úÖ Health summary sent to ${reportData.family.contacts[selectedFamilyMember].name}!\n\nThey'll receive an SMS with your daily progress.`);
                        
                        // Log this action
                        console.log(`Family report sent to: ${reportData.family.contacts[selectedFamilyMember].name}`);
                    } else {
                        alert('‚ö†Ô∏è Failed to send report. Please check your connection and try again.');
                    }
                    
                    isSendingReport = false;
                    card.classList.remove('active');
                    preview.style.display = 'none';
                }, 2000);
            } else {
                card.classList.remove('active');
                preview.style.display = 'none';
                document.getElementById('familyMembersSection').style.display = 'none';
            }
        }, 100);
    }

    function sendDoctorReport() {
        if (isSendingReport) return;
        
        const card = event.target.closest('.share-report-card');
        card.classList.add('active');
        
        // Show doctor selection
        document.getElementById('doctorsSection').style.display = 'block';
        document.getElementById('familyMembersSection').style.display = 'none';
        
        // Show preview
        const preview = card.querySelector('.report-preview');
        preview.style.display = 'block';
        
        setTimeout(() => {
            const confirmSend = confirm(`Send clinical report to ${reportData.doctor.doctors[selectedDoctor].name}?\n\nThis will share detailed medical information.`);
            
            if (confirmSend) {
                isSendingReport = true;
                showSharingLoading('doctor');
                
                setTimeout(() => {
                    // Simulate sending
                    const success = Math.random() > 0.1; // 90% success rate
                    
                    if (success) {
                        showShareSuccess(`‚úÖ Clinical report sent to ${reportData.doctor.doctors[selectedDoctor].name}!\n\nReport includes detailed vitals, medication adherence, and trends.`);
                        
                        // Log this action
                        console.log(`Doctor report sent to: ${reportData.doctor.doctors[selectedDoctor].name}`);
                        
                        // In a real app, this would trigger:
                        // 1. HIPAA-compliant email to doctor
                        // 2. Log entry in audit trail
                        // 3. Patient notification
                    } else {
                        alert('‚ö†Ô∏è Failed to send report. Please try again or contact support.');
                    }
                    
                    isSendingReport = false;
                    card.classList.remove('active');
                    preview.style.display = 'none';
                }, 2500);
            } else {
                card.classList.remove('active');
                preview.style.display = 'none';
                document.getElementById('doctorsSection').style.display = 'none';
            }
        }, 100);
    }

    function selectFamilyMember(element, memberId) {
        document.querySelectorAll('.family-member-option').forEach(opt => {
            opt.classList.remove('selected');
        });
        element.classList.add('selected');
        selectedFamilyMember = memberId;
    }

    function selectDoctor(element, doctorId) {
        document.querySelectorAll('.doctor-option').forEach(opt => {
            opt.classList.remove('selected');
        });
        element.classList.add('selected');
        selectedDoctor = doctorId;
    }

    function addNewFamilyMember() {
        const name = prompt("Enter family member's name:");
        if (name && name.trim()) {
            const phone = prompt("Enter phone number:");
            if (phone && phone.trim()) {
                const id = name.toLowerCase().replace(/\s+/g, '_');
                reportData.family.contacts[id] = { name, phone };
                
                // Add new option
                const container = document.querySelector('#familyMembersSection > div:last-child');
                const newOption = document.createElement('div');
                newOption.className = 'family-member-option';
                newOption.onclick = function() { selectFamilyMember(this, id); };
                newOption.innerHTML = `<i data-lucide="user" style="width: 16px; height: 16px;"></i> ${name}`;
                
                container.insertBefore(newOption, container.lastElementChild);
                
                alert(`‚úÖ ${name} added as emergency contact!`);
                
                // Refresh Lucide icons
                if (window.lucide) {
                    lucide.createIcons();
                }
            }
        }
    }

    function addNewDoctor() {
        const name = prompt("Enter doctor's name:");
        if (name && name.trim()) {
            const specialty = prompt("Enter specialty:");
            const contact = prompt("Enter email or contact:");
            
            if (specialty && contact) {
                const id = name.toLowerCase().replace(/\s+/g, '_');
                reportData.doctor.doctors[id] = { name, specialty, contact };
                
                // Add new option
                const container = document.querySelector('#doctorsSection > div:last-child');
                const newOption = document.createElement('div');
                newOption.className = 'doctor-option';
                newOption.onclick = function() { selectDoctor(this, id); };
                newOption.innerHTML = `<i data-lucide="stethoscope" style="width: 16px; height: 16px;"></i> ${name}`;
                
                container.insertBefore(newOption, container.lastElementChild);
                
                alert(`‚úÖ ${name} added as healthcare provider!`);
                
                // Refresh Lucide icons
                if (window.lucide) {
                    lucide.createIcons();
                }
            }
        }
    }

    // Social Media Sharing Functions
    function shareOnFacebook() {
        const message = document.getElementById('shareMessage').value;
        const url = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(window.location.origin)}&quote=${encodeURIComponent(message)}`;
        window.open(url, '_blank', 'width=600,height=400');
    }

    function shareOnTwitter() {
        const message = document.getElementById('shareMessage').value;
        const url = `https://twitter.com/intent/tweet?text=${encodeURIComponent(message)}&hashtags=HealthJourney,COMPASSHealth`;
        window.open(url, '_blank', 'width=600,height=400');
    }

    function shareOnInstagram() {
        alert('üì± For Instagram, please use the share image feature and post it as a story!');
        generateShareImage();
    }

    function shareOnLinkedIn() {
        const message = document.getElementById('shareMessage').value;
        const url = `https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(window.location.origin)}&summary=${encodeURIComponent(message)}`;
        window.open(url, '_blank', 'width=600,height=400');
    }

    function generateShareImage() {
        const modal = document.createElement('div');
        modal.className = 'share-preview-modal';
        modal.innerHTML = `
            <div class="share-preview-content">
                <div class="share-preview-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <div style="font-weight: bold; color: var(--fg); font-size: 20px;">Share Preview</div>
                    <button onclick="this.parentElement.parentElement.parentElement.remove()" style="background: none; border: none; cursor: pointer; color: var(--muted-2);">
                        <i data-lucide="x"></i>
                    </button>
                </div>
                
                <div style="background: linear-gradient(135deg, #8B5CF6, #EC4899); padding: 30px; border-radius: 20px; color: white; text-align: center;">
                    <div style="font-size: 24px; font-weight: bold; margin-bottom: 10px;">üéâ My Health Journey</div>
                    <div style="font-size: 16px; opacity: 0.9; margin-bottom: 20px;">With COMPASS Health</div>
                    
                    <div style="display: flex; justify-content: center; gap: 30px; margin-bottom: 20px;">
                        <div style="text-align: center;">
                            <div style="font-size: 32px; font-weight: bold;">8</div>
                            <div style="font-size: 12px;">Level</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 32px; font-weight: bold;">28</div>
                            <div style="font-size: 12px;">Day Streak</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 32px; font-weight: bold;">15</div>
                            <div style="font-size: 12px;">Badges</div>
                        </div>
                    </div>
                    
                    <div class="preview-badges" style="justify-content: center;">
                        <div class="preview-badge">üèÜ Consistency</div>
                        <div class="preview-badge">üí™ Strength</div>
                        <div class="preview-badge">üéØ Focus</div>
                        <div class="preview-badge">‚ù§Ô∏è Heart Health</div>
                    </div>
                    
                    <div style="margin-top: 20px; font-size: 14px; opacity: 0.8;">
                        "Taking control of my health, one day at a time!"
                    </div>
                </div>
                
                <div style="margin-top: 20px; color: var(--muted-2); font-size: 14px;">
                    <i data-lucide="info" style="width: 16px; height: 16px;"></i>
                    Save this image and share it on social media
                </div>
                
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button class="btn-secondary" style="flex: 1;" onclick="downloadShareImage()">
                        <i data-lucide="download"></i> Save Image
                    </button>
                    <button class="btn-primary" style="flex: 1;" onclick="shareImageNow()">
                        <i data-lucide="share-2"></i> Share Now
                    </button>
                </div>
            </div>
        `;
        
        document.body.appendChild(modal);
        modal.style.display = 'flex';
        
        // Refresh Lucide icons
        if (window.lucide) {
            lucide.createIcons();
        }
    }

    function downloadShareImage() {
        alert('üì∏ In a real app, this would generate and download a custom image with your progress data!\n\nFor now, take a screenshot to share.');
        // In production: Use html2canvas or similar library to generate image
    }

    function shareImageNow() {
        alert('üì± Share the image via your device\'s native sharing options!');
        // In production: Use Web Share API if available
        if (navigator.share) {
            navigator.share({
                title: 'My Health Journey',
                text: document.getElementById('shareMessage').value,
                url: window.location.origin
            });
        }
    }

    function showSharingLoading(type) {
        // Show loading animation
        const loading = document.createElement('div');
        loading.className = 'sharing-loading show';
        loading.innerHTML = `
            <div style="text-align: center; padding: 40px;">
                <i data-lucide="send" class="pulse" style="font-size: 48px; color: var(--accent-1); margin-bottom: 20px;"></i>
                <div style="font-weight: bold; color: var(--fg); margin-bottom: 10px;">
                    ${type === 'family' ? 'Sending to Family...' : 'Sending to Doctor...'}
                </div>
                <div style="color: var(--muted-2); font-size: 14px;">
                    ${type === 'family' ? 'Preparing health summary' : 'Encrypting clinical data...'}
                </div>
            </div>
        `;
        
        document.querySelector('.settings-card').appendChild(loading);
        
        setTimeout(() => {
            loading.remove();
        }, 2000);
    }

    function showShareSuccess(message) {
        const success = document.createElement('div');
        success.className = 'share-success show';
        success.innerHTML = `
            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                <i data-lucide="check-circle" style="color: var(--ok);"></i>
                <div style="font-weight: bold; color: var(--fg);">Shared Successfully!</div>
            </div>
            <div style="color: var(--muted-2); font-size: 14px; white-space: pre-line;">
                ${message}
            </div>
        `;
        
        const settingsCard = document.querySelector('.settings-card');
        const shareSection = settingsCard.querySelector('.settings-section') || settingsCard;
        shareSection.appendChild(success);
        
        // Remove after 5 seconds
        setTimeout(() => {
            success.remove();
        }, 5000);
    }

    // Initialize share functionality
    document.addEventListener('DOMContentLoaded', function() {
        // Add click effects to share cards
        document.querySelectorAll('.share-report-card').forEach(card => {
            card.addEventListener('click', function(e) {
                if (!e.target.closest('.family-member-option') && !e.target.closest('.doctor-option')) {
                    this.style.transform = 'scale(0.98)';
                    setTimeout(() => {
                        this.style.transform = '';
                    }, 150);
                }
            });
        });
    });
    
</script>
</body>

</html>
